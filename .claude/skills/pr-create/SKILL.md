---
name: pr-create
description: 現在のブランチの変更内容を確認し、GitHub CLIを使ってPR作成を支援してください。
---

# PR作成

現在のブランチの変更内容を確認し、`.github/PULL_REQUEST_TEMPLATE.md`に準拠したフォーマットでPRを作成するスキル。

## PRテンプレート

PRの本文は `.github/PULL_REQUEST_TEMPLATE.md` のフォーマットに従うこと。

**重要:** PR作成前に、必ず `.github/PULL_REQUEST_TEMPLATE.md` を読み取り、最新のフィールド構造を確認してください。テンプレートが更新されている可能性があります。

## ワークフロー

### 1. マージ先ブランチの確認

ユーザーの指示からマージ先ブランチを特定する。指示に含まれていない場合は、必ずユーザーに確認する。推測してデフォルトを使わないこと。

### 2. 現在のブランチの状態を確認

以下のコマンドを並列で実行し、マージ先ブランチとの差分を把握する：

```bash
# 未コミットの変更を確認
git status

# マージ先ブランチとの差分を確認
git diff <マージ先ブランチ>...HEAD

# マージ先ブランチからの全コミット履歴を確認
git log --oneline <マージ先ブランチ>..HEAD

# リモートとの同期状態を確認
git branch -vv
```

### 3. 関連Issueの確認

オープン中のIssueを確認し、このPRに関連するIssueがないか調べる：

```bash
gh issue list --state open
```

関連Issueがあれば、PR本文の経緯セクションに `#XX` でリンクする。

### 4. テンプレートの確認とPR本文の作成

`.github/PULL_REQUEST_TEMPLATE.md` を読み取り、そのフォーマットに従ってPR本文を作成する。

**各セクションの記載ガイドライン:**

- **経緯**: なぜこのPRが必要になったか。関連Issueがあれば `#XX` でリンクする
- **実装内容**: 「何をしたか」だけでなく「なぜその実装を選んだか」の理由を重視して記載する
- **確認内容**: 修正が正しく動作することの確認方法をチェックボックス形式で記載する

### 5. PRの作成

未pushの場合はpushした上で、`gh pr create`コマンドでPRを作成する：

```bash
gh pr create \
  --base <マージ先ブランチ> \
  --head <現在のブランチ> \
  --title "タイトル" \
  --body "$(cat <<'EOF'
[テンプレートに準拠した本文]
EOF
)"
```

### 6. ユーザーへの報告

PR作成後、URLを報告する。

## 注意事項

1. **マージ先ブランチは必ずユーザーから受け取る** - 不明な場合は推測せず確認する
2. **差分はマージ先ブランチとの比較で確認する** - `<マージ先>...HEAD` を使う
3. **関連Issueを確認する** - オープン中のIssueと照合する
4. **全コミットを確認** - 最新コミットだけでなく、マージ先からの全コミットを分析する
5. **理由を重視** - 実装内容セクションでは「何をしたか」より「なぜそうしたか」を重視する
6. **テンプレート準拠** - 独自フォーマットではなく、必ずテンプレートのセクション構造に従う
